<idea-plugin>
    <id>com.reedelk.plugin</id>
    <name>Reedelk IntelliJ flow designer</name>
    <vendor email="info@reedelk.com" url="https://www.reedelk.com">Reedelk</vendor>

    <description>
        <![CDATA[
            <p>Reedelk Integration Platform IntelliJ flow designer</p>
        ]]>
    </description>


    <change-notes><![CDATA[
	    <ul>
	        <li>Feature: New project wizard creates a project with version equal to the Reedelk Runtime Distribution being used for the project.</li>
	        <li>Feature: New project wizard creates Dockerfile and Heroku Procfile. The Dockerfile is created using the same version of the Reedelk Runtime Distribution.</li>
	        <li>Bugfix: Fixed issue which did not correctly dispose the Script Editor Dialog.</li>
        </ul>
      ]]>
    </change-notes>

    <depends>com.intellij.modules.lang</depends>
    <depends>com.intellij.modules.java</depends>
    <depends>org.jetbrains.idea.maven</depends>

    <extensions defaultExtensionNs="com.intellij">

        <!-- File Type -->
        <fileType name="REEDELK_FILE_TYPE_FLOW" extensions="flow" language="JSON" implementationClass="com.reedelk.plugin.filetype.FlowFileType" />
        <fileType name="REEDELK_FILE_TYPE_SUBFLOW" extensions="subflow" language="JSON" implementationClass="com.reedelk.plugin.filetype.SubFlowFileType" />
        <fileType name="REEDELK_FILE_TYPE_CONFIG" extensions="fconfig" language="JSON" implementationClass="com.reedelk.plugin.filetype.FlowConfigFileType" />

        <!-- File Editor -->
        <fileEditorProvider implementation="com.reedelk.plugin.editor.FlowDesignerEditorProvider" order="first"/>
        <fileEditorProvider implementation="com.reedelk.plugin.editor.SubFlowDesignerEditorProvider" order="first"/>

        <stepsBeforeRunProvider implementation="com.reedelk.plugin.runconfig.module.beforetask.ModuleBuilderBeforeTaskProvider"/>

        <!-- Module Builder -->
        <moduleBuilder builderClass="com.reedelk.plugin.builder.ModuleBuilder" id="REEDELK_MODULE_BUILDER" order="first"/>

        <!-- Services -->
        <moduleService serviceInterface="com.reedelk.plugin.service.module.HttpService"
                       serviceImplementation="com.reedelk.plugin.service.module.impl.http.HttpServiceImpl"/>

        <moduleService serviceInterface="com.reedelk.plugin.service.module.PlatformModuleService"
                       serviceImplementation="com.reedelk.plugin.service.module.impl.component.PlatformModuleServiceImpl"/>

        <moduleService serviceInterface="com.reedelk.plugin.service.module.SubflowService"
                       serviceImplementation="com.reedelk.plugin.service.module.impl.subflow.SubflowServiceImpl"/>

        <moduleService serviceInterface="com.reedelk.plugin.service.module.ConfigurationService"
                       serviceImplementation="com.reedelk.plugin.service.module.impl.configuration.ConfigurationServiceImpl"/>

        <moduleService serviceInterface="com.reedelk.plugin.service.module.ScriptService"
                       serviceImplementation="com.reedelk.plugin.service.module.impl.script.ScriptServiceImpl"/>

        <moduleService serviceInterface="com.reedelk.plugin.service.module.RuntimeApiService"
                       serviceImplementation="com.reedelk.plugin.service.module.impl.runtimeapi.RuntimeApiServiceImpl"/>

        <moduleService serviceInterface="com.reedelk.plugin.service.module.DependenciesSyncService"
                       serviceImplementation="com.reedelk.plugin.service.module.impl.syncdeps.DependenciesSyncServiceImpl"/>

        <moduleService serviceInterface="com.reedelk.plugin.service.module.CheckStateService"
                       serviceImplementation="com.reedelk.plugin.service.module.impl.checkstate.CheckStateServiceImpl"/>

        <!-- Program Runner and Executors -->
        <programRunner implementation="com.reedelk.plugin.runconfig.module.runner.DeploymentRunner" order="first"/>
        <executor implementation="com.reedelk.plugin.runconfig.module.runner.ModuleDeployExecutor"/>
        <executor implementation="com.reedelk.plugin.runconfig.module.runner.ModuleUnDeployExecutor"/>

        <!-- Run Configurations -->
        <configurationType implementation="com.reedelk.plugin.runconfig.runtime.RuntimeRunConfigurationType"/>
        <configurationType implementation="com.reedelk.plugin.runconfig.module.ModuleRunConfigurationType"/>

        <!-- Palette and Component properties tool window -->
        <toolWindow id="com.reedelk.plugin.toolwindow.palette.components" anchor="right"
                    factoryClass="com.reedelk.plugin.editor.palette.PaletteToolWindowFactory"/>

        <toolWindow id="com.reedelk.plugin.toolwindow.palette.component.properties" anchor="bottom"
                    factoryClass="com.reedelk.plugin.editor.properties.PropertiesPanelToolWindowFactory"/>

        <fileType name="Reedelk" implementationClass="com.reedelk.plugin.language.ReedelkFileType"
                  fieldName="INSTANCE" language="reedelk" extensions="reedelk"/>

        <lang.syntaxHighlighterFactory language="reedelk"
                                       implementationClass="com.reedelk.plugin.language.ReedelkSyntaxHighlighterFactory"/>

        <completion.contributor language="any"
                                implementationClass="com.reedelk.plugin.completion.ScriptCompletionContributor"
                                order="first"/>

        <lang.parserDefinition language="reedelk"
                               implementationClass="com.reedelk.plugin.language.ReedelkParserDefinition"/>

    </extensions>

    <actions>
        <action id="Reedelk.CreateProjectFile" class="com.reedelk.plugin.action.CreateProjectFile">
            <add-to-group group-id="NewGroup1" anchor="after" relative-to-action="NewClass"/>
        </action>
        <action id="com.reedelk.plugin.action.importopenapi.ActionImportOpenAPI"
                class="com.reedelk.plugin.action.importopenapi.ActionImportOpenAPI"
                text="Import Open API"
                icon="/META-INF/pluginIcon-small.svg"
                description="Import Open API and generate integration flow blueprint for rest based flows.">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
        </action>
    </actions>

    <project-components>
        <component>
            <interface-class>com.reedelk.plugin.service.project.SourceChangeService</interface-class>
            <implementation-class>com.reedelk.plugin.service.project.impl.sourcechange.SourceChangeServiceImpl</implementation-class>
        </component>
        <component>
            <interface-class>com.reedelk.plugin.service.project.PreferredRunConfigurationService</interface-class>
            <implementation-class>com.reedelk.plugin.service.project.impl.runconfiguration.PreferredRunConfigurationServiceImpl</implementation-class>
        </component>
    </project-components>

</idea-plugin>
